{% extends "base.html" %}

{% block title %}관리자 페이지{% endblock %}

{% block content %}
    <ul class="nav nav-tabs mb-3">
        <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/admin/dashboard">User Management</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/admin/videos">Video Management</a>
        </li>
    </ul>
    <h1>사용자 데이터</h1>
    <table border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>Custom ID</th>
                <th>이름</th>
                <th>이메일</th>
                <th>Role</th>
                <th>Credits</th>
                <th>가입일</th>
            </tr>
        </thead>
        <tbody id="user-data">
            <!-- 사용자 데이터가 여기에 동적으로 추가됩니다. -->
        </tbody>
    </table>
{% endblock %}

{% block scripts %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('/admin/users') // Changed to new API endpoint
                .then(response => response.json())
                .then(data => {
                    const userData = document.getElementById('user-data');
                    data.forEach(user => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${user.id}</td>
                            <td>${user.custom_id || 'N/A'}</td>
                            <td>${user.name || 'N/A'}</td>
                            <td>${user.email}</td>
                            <td>${user.role}</td>
                            <td>${user.credits}</td>
                            <td>${new Date(user.created_at).toLocaleDateString()}</td>
                        `;
                        userData.appendChild(row);
                    });
                })
                .catch(error => console.error('Error fetching user data:', error));
        });
    </script>
{% endblock %}